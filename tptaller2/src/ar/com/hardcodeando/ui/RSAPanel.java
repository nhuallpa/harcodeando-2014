/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */


package ar.com.hardcodeando.ui;
import ar.com.hardcodeando.algorithm.RSA;
import java.util.Random;
import javax.swing.*;


/**
 *
 * @author Gabo
 */

public class RSAPanel extends javax.swing.JPanel {

    /**
     * Creates new form RSAPanel
     */
 
    public RSAPanel() {
        
        initComponents();        
        
        this.rsa_aprender = new RSA();
        
        this.RSATabbedPanel.setEnabledAt(2, false);
        this.RSATabbedPanel.setEnabledAt(3, false);
        this.RSATabbedPanel.setEnabledAt(4, false);
        this.RSATabbedPanel.setEnabledAt(5, false);
        this.RSATabbedPanel.setEnabledAt(6, false);
                
        this.spinTamBloque.setValue(1);
        this.panEncriptarBloques.setEnabled(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private boolean EsPrimo(long numero)
    {
        boolean ret = false;
        if(numero != 0)
        {
            int i = 1, j = 0;
            while(j <= 2 && i < numero + 1)
            {
                if(numero % i == 0) j++;                
                i++;
            }
            if(j <= 2) ret = true;
        }
        return ret;
    }
    
    private boolean esNumero(String cadena){
    try {
        Integer.parseInt(cadena);
        return true;
    }catch (NumberFormatException nfe){
        return false;
    }
}
    
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jDialog1 = new javax.swing.JDialog();
        jDialog2 = new javax.swing.JDialog();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        RSATabbedPanel = new javax.swing.JTabbedPane();
        IntroRSAPanel = new javax.swing.JPanel();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jSeparator2 = new javax.swing.JSeparator();
        panelCalculosIniciales = new javax.swing.JPanel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        botComenzar = new javax.swing.JButton();
        panelPaso1 = new javax.swing.JPanel();
        botPrimosAleatorio = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        textP = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        textQ = new javax.swing.JTextField();
        textModulo = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        botCalcularModulo = new javax.swing.JButton();
        jLabel21 = new javax.swing.JLabel();
        botContinuarPaso1 = new javax.swing.JButton();
        panelPaso2 = new javax.swing.JPanel();
        jLabel22 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        text_p_paso2 = new javax.swing.JTextField();
        text_q_paso2 = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        textIntervalo_d = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        text_d = new javax.swing.JTextField();
        botHallar_d = new javax.swing.JButton();
        botContinuarPaso2 = new javax.swing.JButton();
        text_claveprivada = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        panelPaso3 = new javax.swing.JPanel();
        jLabel23 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        text_q_paso3 = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        text_p_paso3 = new javax.swing.JTextField();
        text_d_paso3 = new javax.swing.JTextField();
        jLabel17 = new javax.swing.JLabel();
        text_e_paso3 = new javax.swing.JTextField();
        botHallar_e = new javax.swing.JButton();
        text_claveprivada1 = new javax.swing.JTextField();
        jLabel24 = new javax.swing.JLabel();
        botContinuarPaso3 = new javax.swing.JButton();
        panelPaso4 = new javax.swing.JPanel();
        jLabel25 = new javax.swing.JLabel();
        jLabel27 = new javax.swing.JLabel();
        textMensajeEncriptar = new javax.swing.JTextField();
        jLabel28 = new javax.swing.JLabel();
        botEncriptarTodo = new javax.swing.JButton();
        botEncriptarBloques = new javax.swing.JButton();
        panEncriptarBloques = new javax.swing.JPanel();
        labelBloque = new javax.swing.JLabel();
        textBloqueEncriptar = new javax.swing.JTextField();
        labelRepNum = new javax.swing.JLabel();
        textASCIIencriptar = new javax.swing.JTextField();
        botEncriptarBloque = new javax.swing.JButton();
        botTerminarEncriptar = new javax.swing.JButton();
        textMensCifrado = new javax.swing.JTextField();
        jLabel29 = new javax.swing.JLabel();
        botContinuarEncriptar = new javax.swing.JButton();
        labelTamBloq = new javax.swing.JLabel();
        spinTamBloque = new javax.swing.JSpinner();
        panelPaso5 = new javax.swing.JPanel();
        panelPaso6 = new javax.swing.JPanel();
        jLabel30 = new javax.swing.JLabel();
        jLabel31 = new javax.swing.JLabel();
        textMensajeDesencriptar = new javax.swing.JTextField();
        jLabel32 = new javax.swing.JLabel();
        botDesencriptarBloqueBloque = new javax.swing.JButton();
        panEncriptarBloques1 = new javax.swing.JPanel();
        labelBloqueDes = new javax.swing.JLabel();
        textBloqueDesencriptar = new javax.swing.JTextField();
        labelRepNumdes = new javax.swing.JLabel();
        textASCIIdesencriptar = new javax.swing.JTextField();
        botdesencriptarBloque = new javax.swing.JButton();
        botTerminarDesencriptar = new javax.swing.JButton();
        textMensOriginalDesencriptar = new javax.swing.JTextField();
        jLabel33 = new javax.swing.JLabel();
        labelTamBloqDes = new javax.swing.JLabel();
        spinTamBloqueDes = new javax.swing.JSpinner();
        botDesencriptarTodo = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();

        javax.swing.GroupLayout jDialog1Layout = new javax.swing.GroupLayout(jDialog1.getContentPane());
        jDialog1.getContentPane().setLayout(jDialog1Layout);
        jDialog1Layout.setHorizontalGroup(
            jDialog1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jDialog1Layout.setVerticalGroup(
            jDialog1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jDialog2Layout = new javax.swing.GroupLayout(jDialog2.getContentPane());
        jDialog2.getContentPane().setLayout(jDialog2Layout);
        jDialog2Layout.setHorizontalGroup(
            jDialog2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jDialog2Layout.setVerticalGroup(
            jDialog2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 100, Short.MAX_VALUE)
        );

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel1.setText("RSA");

        RSATabbedPanel.setFocusable(false);
        RSATabbedPanel.setPreferredSize(new java.awt.Dimension(1200, 800));

        IntroRSAPanel.setPreferredSize(new java.awt.Dimension(500, 250));
        IntroRSAPanel.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel14.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel14.setText("Introducción");
        IntroRSAPanel.add(jLabel14, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 10, -1, -1));

        jLabel15.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel15.setText("<html>RSA es un criptosistema asimétrico que sirve tanto para encriptar mensajes como para autenticación de documentos o transacciones (Firmas Digitales).<br><br> Fue creado en 1977 por Ron Rivest, Adi Shamir y Leonard Adelman. Sus apellidos son las siglas del nombre del algoritmo. <br><br> Este criptosistema basa su seguridad en que no existe una manera rápida y sencilla de factorizar cantidades que son producto de 2 números primos grandes <br><br> Un usuario del sistema RSA crea y publica el producto de 2 grandes números, junto con un valor auxiliar, como su clave pública <br><br> Los <strong>factores primos</strong> deben mantenerse en secreto. Cualquier persona puede utilizar la clave pública para cifrar un mensaje, pero si la misma es \tlo suficientemente grande solo alguien con el conocimiento de los factores primos es factible de descifrar el mensaje <br><br> </html>");
        IntroRSAPanel.add(jLabel15, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 50, 780, 200));
        IntroRSAPanel.add(jSeparator2, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 182, 840, 0));

        RSATabbedPanel.addTab("Introducción", IntroRSAPanel);

        panelCalculosIniciales.setPreferredSize(new java.awt.Dimension(1800, 800));

        jLabel18.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel18.setText("Cálculos Iniciales");

        jLabel19.setText("<html>1 - Se seleccionan en forma aleatoria 2 números primos largos <strong> p </strong> y <strong> q </strong> y se calcula el producto <strong> n = p &times; q </strong>. El valor n se denomina <strong> módulo </strong>.<br><br>2 - Se elige un número denominado <strong> d </strong>, menor que el módulo calculado y que sea <strong>relativamente primo</strong> al producto de <strong>(p-1)&times;(q-1)</strong>.<br><br>3- Se calcula un número entero denominado <strong>e</strong> que esté dentro del rango <strong>1 &le; e &le; (p-1)&times;(q-1)</strong>.</html>");

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel5.setText("Conclusiones");

        jLabel20.setText("<html>La <strong>clave pública</strong> la forman la pareja <strong>(n,e)</strong> y la <strong>clave privada</strong> la forman la pareja <strong>(n,d)</strong>.<br><br>Con la clave pública se procede a encriptar el mensaje, para luego ser desencriptado con la clave privada.<br><br>Es difícil obtener la clave privada <strong>d</strong> a partir de la clave pública <strong>(n,e)</strong>. Si se logra <strong>factorizar</strong> n en p y q, podría ser obtenida.<br><br>La seguridad del RSA se basa en la idea de que esta factorización es sumamente complicada de efectuar.<br><br>La relación entre <strong>d</strong> y <strong>e</strong> asegura una correcta reconstrucción de los mensajes. Debido a que solo el receptor conoce la clave secreta <strong>d</strong> solamente él puede desencriptarlo.<br><br>Es responsabilidad del receptor mantener el secreto de la clave privada.</html>");

        botComenzar.setText("Comenzar");
        botComenzar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botComenzarMousePressed(evt);
            }
        });

        javax.swing.GroupLayout panelCalculosInicialesLayout = new javax.swing.GroupLayout(panelCalculosIniciales);
        panelCalculosIniciales.setLayout(panelCalculosInicialesLayout);
        panelCalculosInicialesLayout.setHorizontalGroup(
            panelCalculosInicialesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelCalculosInicialesLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelCalculosInicialesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel19, javax.swing.GroupLayout.PREFERRED_SIZE, 780, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(panelCalculosInicialesLayout.createSequentialGroup()
                        .addComponent(jLabel20, javax.swing.GroupLayout.PREFERRED_SIZE, 780, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(botComenzar))
                    .addComponent(jLabel18)
                    .addComponent(jLabel5))
                .addContainerGap(677, Short.MAX_VALUE))
        );
        panelCalculosInicialesLayout.setVerticalGroup(
            panelCalculosInicialesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelCalculosInicialesLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel18)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(31, 31, 31)
                .addGroup(panelCalculosInicialesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(panelCalculosInicialesLayout.createSequentialGroup()
                        .addComponent(jLabel5)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel20, javax.swing.GroupLayout.PREFERRED_SIZE, 204, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(botComenzar))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        RSATabbedPanel.addTab("Cálculos Iniciales", panelCalculosIniciales);

        panelPaso1.setEnabled(false);

        botPrimosAleatorio.setText("Aleatorio");
        botPrimosAleatorio.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botPrimosAleatorioMousePressed(evt);
            }
        });
        botPrimosAleatorio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botPrimosAleatorioActionPerformed(evt);
            }
        });

        jLabel2.setText("<html>Como primera medida tenemos que hallar los dos números primos para luego calcular el módulo. <br><br>Por lo general deben ser números muy grandes del orden de los 100 dígitos para que sea muy dificil romper el criptosistema.<br><br> Para fines didáticos usaremos números primos chicos, tomando como valor máximo el número 31. </html>");

        jLabel3.setText("p");

        textP.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textPActionPerformed(evt);
            }
        });

        jLabel4.setText("q");

        textQ.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textQActionPerformed(evt);
            }
        });

        textModulo.setEditable(false);
        textModulo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textModuloActionPerformed(evt);
            }
        });

        jLabel6.setText("<html>Módulo n = p &times; q</html>");

        botCalcularModulo.setText("Calcular");
        botCalcularModulo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botCalcularModuloMousePressed(evt);
            }
        });

        jLabel21.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel21.setText("Paso 1: Hallar el módulo");

        botContinuarPaso1.setText("Continuar");
        botContinuarPaso1.setEnabled(false);
        botContinuarPaso1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botContinuarPaso1MousePressed(evt);
            }
        });
        botContinuarPaso1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botContinuarPaso1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout panelPaso1Layout = new javax.swing.GroupLayout(panelPaso1);
        panelPaso1.setLayout(panelPaso1Layout);
        panelPaso1Layout.setHorizontalGroup(
            panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso1Layout.createSequentialGroup()
                .addGroup(panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelPaso1Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addGroup(panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel21)))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelPaso1Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelPaso1Layout.createSequentialGroup()
                                .addComponent(textP, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel4)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(textQ, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(botPrimosAleatorio))
                            .addGroup(panelPaso1Layout.createSequentialGroup()
                                .addComponent(textModulo, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(botCalcularModulo, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(panelPaso1Layout.createSequentialGroup()
                                .addGap(108, 108, 108)
                                .addComponent(botContinuarPaso1)))
                        .addGap(156, 156, 156)))
                .addContainerGap(941, Short.MAX_VALUE))
        );
        panelPaso1Layout.setVerticalGroup(
            panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso1Layout.createSequentialGroup()
                .addGap(22, 22, 22)
                .addComponent(jLabel21)
                .addGap(18, 18, 18)
                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(91, 91, 91)
                .addGroup(panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(textP, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(textQ, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel4)
                    .addComponent(jLabel3)
                    .addComponent(botPrimosAleatorio))
                .addGap(11, 11, 11)
                .addGroup(panelPaso1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(textModulo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(botCalcularModulo))
                .addGap(46, 46, 46)
                .addComponent(botContinuarPaso1)
                .addContainerGap(359, Short.MAX_VALUE))
        );

        RSATabbedPanel.addTab("Paso 1", panelPaso1);

        jLabel22.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel22.setText("Paso 2: Hallar componente d.");

        jLabel7.setText("<html>En este paso buscaremos un valor numérico al que llamaremos <strong>d</strong>. Este valor será junto con el módulo hallado en el paso anterior la <strong>clave privada</strong> para poder desencriptar.<br><br>Este valor debe ser relativamente primo al producto (p-1)&times;(q-1).<br><br>Escogeremos un valor perteneciente al intervalo <strong>[max(p,q)+1,n-1]</strong><br><br>El par <strong>(n,d)</strong> será la clave privada que deberá saber resguardar el receptor para poder desencriptar</html>");

        jLabel8.setText("p");

        text_p_paso2.setEditable(false);
        text_p_paso2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                text_p_paso2ActionPerformed(evt);
            }
        });

        text_q_paso2.setEditable(false);

        jLabel9.setText("q");

        textIntervalo_d.setEditable(false);
        textIntervalo_d.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textIntervalo_dActionPerformed(evt);
            }
        });

        jLabel10.setText("Intervalo");

        text_d.setEditable(false);

        botHallar_d.setText("Hallar d");

        botContinuarPaso2.setText("Continuar");
        botContinuarPaso2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botContinuarPaso2MousePressed(evt);
            }
        });

        text_claveprivada.setEditable(false);

        jLabel11.setText("Clave Privada");

        javax.swing.GroupLayout panelPaso2Layout = new javax.swing.GroupLayout(panelPaso2);
        panelPaso2.setLayout(panelPaso2Layout);
        panelPaso2Layout.setHorizontalGroup(
            panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso2Layout.createSequentialGroup()
                .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelPaso2Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel22)))
                    .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addComponent(botContinuarPaso2)
                        .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(panelPaso2Layout.createSequentialGroup()
                                .addGap(270, 270, 270)
                                .addComponent(jLabel8)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(text_p_paso2, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(23, 23, 23)
                                .addComponent(jLabel9)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(text_q_paso2, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelPaso2Layout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(jLabel10)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(panelPaso2Layout.createSequentialGroup()
                                        .addComponent(text_d, javax.swing.GroupLayout.PREFERRED_SIZE, 78, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(botHallar_d, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addComponent(textIntervalo_d, javax.swing.GroupLayout.PREFERRED_SIZE, 160, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelPaso2Layout.createSequentialGroup()
                                .addGap(211, 211, 211)
                                .addComponent(jLabel11)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(text_claveprivada, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addContainerGap(708, Short.MAX_VALUE))
        );
        panelPaso2Layout.setVerticalGroup(
            panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso2Layout.createSequentialGroup()
                .addGap(23, 23, 23)
                .addComponent(jLabel22)
                .addGap(18, 18, 18)
                .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(text_q_paso2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_p_paso2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9)
                    .addComponent(jLabel8))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(textIntervalo_d, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel10))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(botHallar_d)
                    .addComponent(text_d, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(panelPaso2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(text_claveprivada, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel11))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(botContinuarPaso2)
                .addContainerGap(406, Short.MAX_VALUE))
        );

        RSATabbedPanel.addTab("Paso 2", panelPaso2);

        jLabel23.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel23.setText("Paso 3: Hallar componente e.");

        jLabel12.setText("<html>Lo que hay que hacer luego de hallar la clave privada, es hallar un valor entero <strong>e</strong> que será junto con el módulo encontrado en el paso 1 la <strong>clave pública</strong> y servirá para encriptar los mensajes.<br><br>Este valor debe estar dentro del rango <strong>1 &le; e &le; (p-1)&times;(q-1)</strong><br><br>Por lo tanto aplicaremos la siguiente ecuación, en donde despejaremos el valor de <strong>e</strong>:<br><br><strong>e &times; d = 1 mod [(p-1) &times; (q-1)]</strong></html>");

        text_q_paso3.setEditable(false);
        text_q_paso3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                text_q_paso3ActionPerformed(evt);
            }
        });

        jLabel13.setText("p");

        jLabel16.setText("q");

        text_p_paso3.setEditable(false);
        text_p_paso3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                text_p_paso3ActionPerformed(evt);
            }
        });

        text_d_paso3.setEditable(false);
        text_d_paso3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                text_d_paso3ActionPerformed(evt);
            }
        });

        jLabel17.setText("d");

        text_e_paso3.setEditable(false);
        text_e_paso3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                text_e_paso3ActionPerformed(evt);
            }
        });

        botHallar_e.setText("Hallar e");

        text_claveprivada1.setEditable(false);

        jLabel24.setText("Clave Pública");

        botContinuarPaso3.setText("Continuar");
        botContinuarPaso3.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botContinuarPaso3MousePressed(evt);
            }
        });

        javax.swing.GroupLayout panelPaso3Layout = new javax.swing.GroupLayout(panelPaso3);
        panelPaso3.setLayout(panelPaso3Layout);
        panelPaso3Layout.setHorizontalGroup(
            panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso3Layout.createSequentialGroup()
                .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelPaso3Layout.createSequentialGroup()
                        .addGap(20, 20, 20)
                        .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel23)))
                    .addGroup(panelPaso3Layout.createSequentialGroup()
                        .addGap(199, 199, 199)
                        .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelPaso3Layout.createSequentialGroup()
                                .addComponent(jLabel13)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(text_p_paso3, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel16))
                            .addComponent(jLabel24, javax.swing.GroupLayout.Alignment.TRAILING))
                        .addGap(10, 10, 10)
                        .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(botContinuarPaso3)
                            .addGroup(panelPaso3Layout.createSequentialGroup()
                                .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addGroup(panelPaso3Layout.createSequentialGroup()
                                        .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addComponent(text_e_paso3, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(text_q_paso3, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(jLabel17)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(botHallar_e, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                            .addComponent(text_d_paso3)))
                                    .addComponent(text_claveprivada1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 152, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(4, 4, 4)))))
                .addContainerGap(612, Short.MAX_VALUE))
        );
        panelPaso3Layout.setVerticalGroup(
            panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso3Layout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addComponent(jLabel23)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(59, 59, 59)
                .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(text_d_paso3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(text_q_paso3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17)
                    .addComponent(jLabel16)
                    .addComponent(text_p_paso3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel13))
                .addGap(13, 13, 13)
                .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(botHallar_e)
                    .addComponent(text_e_paso3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(panelPaso3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(text_claveprivada1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel24))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(botContinuarPaso3)
                .addContainerGap(385, Short.MAX_VALUE))
        );

        RSATabbedPanel.addTab("Paso 3", panelPaso3);

        jLabel25.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel25.setText("Paso 4: Encriptar.");

        jLabel27.setText("<html>Para encriptar mensajes, primero definiremos una asociación numérica para cada caracter.<br><br>En nuestro caso, utilizaremos el código ASCII, por ejemplo <strong>A = 65 , a = 97, etc.</strong><br><br>Podemos codificar caracter por caracter, aplicando su código numérico, o tomar bloques de mayor cantidad de caracteres y codificar de a grupos.<br><br>Cada grupo de caracteres se encripta  con la siguiente fórmula: <strong>C = M<sup>e</sup>mod n</strong> donde M es el valor del grupo de caracteres, C el valor encriptado,<br> e y n los componentes de la clave pública.</html>");

        textMensajeEncriptar.setHorizontalAlignment(javax.swing.JTextField.LEFT);
        textMensajeEncriptar.setText("TOP SECRET MESSAGE");
        textMensajeEncriptar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textMensajeEncriptarActionPerformed(evt);
            }
        });

        jLabel28.setText("Mensaje Original:");

        botEncriptarTodo.setText("Encriptar Todo");

        botEncriptarBloques.setText("Encriptar Bloque a Bloque");
        botEncriptarBloques.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botEncriptarBloquesMousePressed(evt);
            }
        });
        botEncriptarBloques.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botEncriptarBloquesActionPerformed(evt);
            }
        });

        panEncriptarBloques.setEnabled(false);

        labelBloque.setText("Bloque:");
        labelBloque.setEnabled(false);

        textBloqueEncriptar.setEditable(false);
        textBloqueEncriptar.setEnabled(false);

        labelRepNum.setText("Representación numérica:");
        labelRepNum.setEnabled(false);

        textASCIIencriptar.setEditable(false);
        textASCIIencriptar.setEnabled(false);

        botEncriptarBloque.setText("Encriptar Bloque");
        botEncriptarBloque.setEnabled(false);
        botEncriptarBloque.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botEncriptarBloqueActionPerformed(evt);
            }
        });

        botTerminarEncriptar.setText("Terminar");
        botTerminarEncriptar.setEnabled(false);

        javax.swing.GroupLayout panEncriptarBloquesLayout = new javax.swing.GroupLayout(panEncriptarBloques);
        panEncriptarBloques.setLayout(panEncriptarBloquesLayout);
        panEncriptarBloquesLayout.setHorizontalGroup(
            panEncriptarBloquesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panEncriptarBloquesLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(labelBloque)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(textBloqueEncriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(labelRepNum)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(textASCIIencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panEncriptarBloquesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(botTerminarEncriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(botEncriptarBloque))
                .addContainerGap(88, Short.MAX_VALUE))
        );
        panEncriptarBloquesLayout.setVerticalGroup(
            panEncriptarBloquesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panEncriptarBloquesLayout.createSequentialGroup()
                .addGap(37, 37, 37)
                .addGroup(panEncriptarBloquesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(labelBloque)
                    .addComponent(textBloqueEncriptar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(labelRepNum)
                    .addComponent(botEncriptarBloque)
                    .addComponent(textASCIIencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(botTerminarEncriptar)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        textMensCifrado.setEditable(false);
        textMensCifrado.setHorizontalAlignment(javax.swing.JTextField.LEFT);
        textMensCifrado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textMensCifradoActionPerformed(evt);
            }
        });

        jLabel29.setText("Mensaje Cifrado:");

        botContinuarEncriptar.setText("Continuar");
        botContinuarEncriptar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botContinuarEncriptarMousePressed(evt);
            }
        });

        labelTamBloq.setText("Tamaño bloque:");

        javax.swing.GroupLayout panelPaso4Layout = new javax.swing.GroupLayout(panelPaso4);
        panelPaso4.setLayout(panelPaso4Layout);
        panelPaso4Layout.setHorizontalGroup(
            panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso4Layout.createSequentialGroup()
                .addGap(21, 21, 21)
                .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelPaso4Layout.createSequentialGroup()
                        .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelPaso4Layout.createSequentialGroup()
                                .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jLabel28)
                                    .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jLabel29)
                                        .addComponent(labelTamBloq)))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(textMensCifrado, javax.swing.GroupLayout.PREFERRED_SIZE, 319, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(spinTamBloque, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(textMensajeEncriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 319, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(botEncriptarBloques, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(botEncriptarTodo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                            .addGroup(panelPaso4Layout.createSequentialGroup()
                                .addComponent(panEncriptarBloques, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, Short.MAX_VALUE)))
                        .addGap(18, 18, 18)
                        .addComponent(botContinuarEncriptar))
                    .addGroup(panelPaso4Layout.createSequentialGroup()
                        .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelPaso4Layout.createSequentialGroup()
                                .addGap(1, 1, 1)
                                .addComponent(jLabel25))
                            .addComponent(jLabel27, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 179, Short.MAX_VALUE)))
                .addContainerGap(652, Short.MAX_VALUE))
        );
        panelPaso4Layout.setVerticalGroup(
            panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso4Layout.createSequentialGroup()
                .addGap(25, 25, 25)
                .addComponent(jLabel25)
                .addGap(18, 18, 18)
                .addComponent(jLabel27, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(textMensajeEncriptar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel28)
                    .addComponent(botEncriptarBloques))
                .addGap(1, 1, 1)
                .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(botEncriptarTodo)
                    .addComponent(textMensCifrado, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel29))
                .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelPaso4Layout.createSequentialGroup()
                        .addGap(80, 80, 80)
                        .addComponent(botContinuarEncriptar))
                    .addGroup(panelPaso4Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(panelPaso4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(labelTamBloq)
                            .addComponent(spinTamBloque, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(panEncriptarBloques, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(331, Short.MAX_VALUE))
        );

        RSATabbedPanel.addTab("Paso 4", panelPaso4);

        jLabel30.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel30.setText("Paso 5: Desencriptar.");

        jLabel31.setText("<html>Una vez que el receptor recibe un mensaje encriptado, procede a desencriptarlo a través de su clave privada. <br><br>La fórmula para efectuar el proceso es: <strong>M = C<sup>d</sup>mod n</strong> donde C es el valor numérico de los caracteres encriptados, M el valor numérico del mensaje original que se acaba de desencriptar,<br>(los valores numéricos son los códigos ASCII para nuestros ejemplos), d y n los componentes de la clave privada.</html>");

        textMensajeDesencriptar.setEditable(false);
        textMensajeDesencriptar.setHorizontalAlignment(javax.swing.JTextField.LEFT);
        textMensajeDesencriptar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textMensajeDesencriptarActionPerformed(evt);
            }
        });

        jLabel32.setText("Mensaje Cifrado:");

        botDesencriptarBloqueBloque.setText("Desencriptar Bloque a Bloque");
        botDesencriptarBloqueBloque.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botDesencriptarBloqueBloqueMousePressed(evt);
            }
        });
        botDesencriptarBloqueBloque.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botDesencriptarBloqueBloqueActionPerformed(evt);
            }
        });

        panEncriptarBloques1.setEnabled(false);

        labelBloqueDes.setText("Bloque:");
        labelBloqueDes.setEnabled(false);

        textBloqueDesencriptar.setEditable(false);
        textBloqueDesencriptar.setEnabled(false);

        labelRepNumdes.setText("Representación numérica:");
        labelRepNumdes.setEnabled(false);

        textASCIIdesencriptar.setEditable(false);
        textASCIIdesencriptar.setEnabled(false);

        botdesencriptarBloque.setText("Desencriptar Bloque");
        botdesencriptarBloque.setEnabled(false);
        botdesencriptarBloque.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botdesencriptarBloqueActionPerformed(evt);
            }
        });

        botTerminarDesencriptar.setText("Terminar");
        botTerminarDesencriptar.setEnabled(false);

        javax.swing.GroupLayout panEncriptarBloques1Layout = new javax.swing.GroupLayout(panEncriptarBloques1);
        panEncriptarBloques1.setLayout(panEncriptarBloques1Layout);
        panEncriptarBloques1Layout.setHorizontalGroup(
            panEncriptarBloques1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panEncriptarBloques1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(labelBloqueDes)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(textBloqueDesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(labelRepNumdes)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(textASCIIdesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panEncriptarBloques1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(botTerminarDesencriptar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(botdesencriptarBloque, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(88, Short.MAX_VALUE))
        );
        panEncriptarBloques1Layout.setVerticalGroup(
            panEncriptarBloques1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panEncriptarBloques1Layout.createSequentialGroup()
                .addGap(37, 37, 37)
                .addGroup(panEncriptarBloques1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(labelBloqueDes)
                    .addComponent(textBloqueDesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(labelRepNumdes)
                    .addComponent(botdesencriptarBloque)
                    .addComponent(textASCIIdesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(botTerminarDesencriptar)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        textMensOriginalDesencriptar.setEditable(false);
        textMensOriginalDesencriptar.setHorizontalAlignment(javax.swing.JTextField.LEFT);
        textMensOriginalDesencriptar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                textMensOriginalDesencriptarActionPerformed(evt);
            }
        });

        jLabel33.setText("Mensaje Original:");

        labelTamBloqDes.setText("Tamaño bloque:");

        spinTamBloqueDes.setEnabled(false);

        botDesencriptarTodo.setText("Desencriptar Todo");
        botDesencriptarTodo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                botDesencriptarTodoMousePressed(evt);
            }
        });
        botDesencriptarTodo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                botDesencriptarTodoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout panelPaso6Layout = new javax.swing.GroupLayout(panelPaso6);
        panelPaso6.setLayout(panelPaso6Layout);
        panelPaso6Layout.setHorizontalGroup(
            panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso6Layout.createSequentialGroup()
                .addGroup(panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelPaso6Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel30)
                            .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(panelPaso6Layout.createSequentialGroup()
                                .addGap(6, 6, 6)
                                .addComponent(labelTamBloqDes)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(spinTamBloqueDes, javax.swing.GroupLayout.PREFERRED_SIZE, 55, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(panelPaso6Layout.createSequentialGroup()
                                .addComponent(jLabel33)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(textMensajeDesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 319, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(textMensOriginalDesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, 319, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(3, 3, 3)
                                .addGroup(panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(botDesencriptarBloqueBloque, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(botDesencriptarTodo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                            .addComponent(panEncriptarBloques1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(panelPaso6Layout.createSequentialGroup()
                        .addGap(8, 8, 8)
                        .addComponent(jLabel32)))
                .addContainerGap(485, Short.MAX_VALUE))
        );
        panelPaso6Layout.setVerticalGroup(
            panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso6Layout.createSequentialGroup()
                .addGap(25, 25, 25)
                .addComponent(jLabel30)
                .addGap(18, 18, 18)
                .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(textMensajeDesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel32)
                    .addComponent(botDesencriptarBloqueBloque))
                .addGap(1, 1, 1)
                .addGroup(panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(textMensOriginalDesencriptar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel33)
                    .addComponent(botDesencriptarTodo))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(panelPaso6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(spinTamBloqueDes, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(labelTamBloqDes))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(panEncriptarBloques1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(383, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout panelPaso5Layout = new javax.swing.GroupLayout(panelPaso5);
        panelPaso5.setLayout(panelPaso5Layout);
        panelPaso5Layout.setHorizontalGroup(
            panelPaso5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(panelPaso6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        panelPaso5Layout.setVerticalGroup(
            panelPaso5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelPaso5Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(panelPaso6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        RSATabbedPanel.addTab("Paso 5", panelPaso5);

        jButton4.setText("Cerrar");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(383, 383, 383)
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 1164, Short.MAX_VALUE)
                .addComponent(jButton4)
                .addContainerGap())
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(RSATabbedPanel, javax.swing.GroupLayout.DEFAULT_SIZE, 1557, Short.MAX_VALUE)
                .addGap(89, 89, 89))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jButton4))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 18, Short.MAX_VALUE)
                .addComponent(RSATabbedPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 736, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(64, 64, 64))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(1546, Short.MAX_VALUE))
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(106, 106, 106)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(677, Short.MAX_VALUE))
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 14, Short.MAX_VALUE)
                    .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 14, Short.MAX_VALUE)))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton4ActionPerformed

    private void botComenzarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botComenzarMousePressed
        this.RSATabbedPanel.setEnabledAt(this.RSATabbedPanel.getSelectedIndex()+1, true);
        this.RSATabbedPanel.setSelectedIndex(this.RSATabbedPanel.getSelectedIndex()+1);
    }//GEN-LAST:event_botComenzarMousePressed

    private void text_q_paso3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_text_q_paso3ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_text_q_paso3ActionPerformed

    private void text_p_paso3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_text_p_paso3ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_text_p_paso3ActionPerformed

    private void text_d_paso3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_text_d_paso3ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_text_d_paso3ActionPerformed

    private void text_e_paso3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_text_e_paso3ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_text_e_paso3ActionPerformed

    private void botContinuarPaso3MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botContinuarPaso3MousePressed
        this.RSATabbedPanel.setEnabledAt(this.RSATabbedPanel.getSelectedIndex()+1, true);
        this.RSATabbedPanel.setSelectedIndex(this.RSATabbedPanel.getSelectedIndex()+1);
    }//GEN-LAST:event_botContinuarPaso3MousePressed

    private void textMensajeEncriptarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textMensajeEncriptarActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textMensajeEncriptarActionPerformed

    private void botEncriptarBloqueActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botEncriptarBloqueActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botEncriptarBloqueActionPerformed

    private void botEncriptarBloquesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botEncriptarBloquesActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botEncriptarBloquesActionPerformed

    private void botEncriptarBloquesMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botEncriptarBloquesMousePressed
        this.labelBloque.setEnabled(true);
        this.labelRepNum.setEnabled(true);
        this.labelTamBloq.setEnabled(true);
        this.botEncriptarBloque.setEnabled(true);
        this.botTerminarEncriptar.setEnabled(true);      
        this.textBloqueEncriptar.setEnabled(true);
        this.textASCIIencriptar.setEnabled(true);
        this.panEncriptarBloques.setEnabled(true);
    }//GEN-LAST:event_botEncriptarBloquesMousePressed

    private void textMensCifradoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textMensCifradoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textMensCifradoActionPerformed

    private void botContinuarEncriptarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botContinuarEncriptarMousePressed
        this.RSATabbedPanel.setEnabledAt(this.RSATabbedPanel.getSelectedIndex()+1, true);
        this.RSATabbedPanel.setSelectedIndex(this.RSATabbedPanel.getSelectedIndex()+1);
        this.spinTamBloqueDes.setValue(this.spinTamBloque.getValue());
    }//GEN-LAST:event_botContinuarEncriptarMousePressed

    private void textMensajeDesencriptarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textMensajeDesencriptarActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textMensajeDesencriptarActionPerformed

    private void botDesencriptarBloqueBloqueMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botDesencriptarBloqueBloqueMousePressed
            this.labelBloqueDes.setEnabled(true);
            this.labelRepNumdes.setEnabled(true);
            this.labelTamBloqDes.setEnabled(true);
            this.textBloqueDesencriptar.setEnabled(true);
            this.textASCIIdesencriptar.setEnabled(true);
            this.botdesencriptarBloque.setEnabled(true);
            this.botTerminarDesencriptar.setEnabled(true);
            
    }//GEN-LAST:event_botDesencriptarBloqueBloqueMousePressed

    private void botDesencriptarBloqueBloqueActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botDesencriptarBloqueBloqueActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botDesencriptarBloqueBloqueActionPerformed

    private void botdesencriptarBloqueActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botdesencriptarBloqueActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botdesencriptarBloqueActionPerformed

    private void textMensOriginalDesencriptarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textMensOriginalDesencriptarActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textMensOriginalDesencriptarActionPerformed

    private void botDesencriptarTodoMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botDesencriptarTodoMousePressed
        // TODO add your handling code here:
    }//GEN-LAST:event_botDesencriptarTodoMousePressed

    private void botDesencriptarTodoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botDesencriptarTodoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botDesencriptarTodoActionPerformed

    private void botContinuarPaso2MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botContinuarPaso2MousePressed
        this.RSATabbedPanel.setEnabledAt(this.RSATabbedPanel.getSelectedIndex()+1, true);
        this.RSATabbedPanel.setSelectedIndex(this.RSATabbedPanel.getSelectedIndex()+1);
    }//GEN-LAST:event_botContinuarPaso2MousePressed

    private void textIntervalo_dActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textIntervalo_dActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textIntervalo_dActionPerformed

    private void text_p_paso2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_text_p_paso2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_text_p_paso2ActionPerformed

    private void botContinuarPaso1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botContinuarPaso1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botContinuarPaso1ActionPerformed

    private void botContinuarPaso1MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botContinuarPaso1MousePressed
        this.RSATabbedPanel.setEnabledAt(this.RSATabbedPanel.getSelectedIndex()+1, true);
        this.RSATabbedPanel.setSelectedIndex(this.RSATabbedPanel.getSelectedIndex()+1);
    }//GEN-LAST:event_botContinuarPaso1MousePressed

    private void botCalcularModuloMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botCalcularModuloMousePressed
        String p = this.textP.getText();
        String q = this.textQ.getText();
        int max_primo = this.rsa_aprender.GetMaxPrimo();
        if(p.isEmpty() || q.isEmpty() )
        {
            JOptionPane.showMessageDialog(null, "Ingrese números primos p y q para calcular el módulo");
            this.textP.setText("");
            this.textQ.setText("");
            this.textModulo.setText("");
        }
        else
        {
            if (!this.esNumero(p) || !this.esNumero(q))
            {
                JOptionPane.showMessageDialog(null, "Debe ingresar valores numéricos");
                this.textP.setText("");
                this.textQ.setText("");
                this.textModulo.setText("");
            }
            else
            {
                long pe = Long.parseLong(p);
                long qu = Long.parseLong(q);
                if(!this.rsa_aprender.SetP(pe)){
                    JOptionPane.showMessageDialog(null, p + " no es un número primo");
                    this.textP.setText("");
                    this.textQ.setText("");
                    this.textModulo.setText("");
                }
                else{
                    if(!this.rsa_aprender.SetQ(qu)){
                        JOptionPane.showMessageDialog(null, q + " no es un número primo");
                        this.textP.setText("");
                        this.textQ.setText("");
                        this.textModulo.setText("");
                    }
                    else{
                        if(pe > max_primo || qu > max_primo){
                            JOptionPane.showMessageDialog(null, "Para fines didácticos, los números primos deben ser menores o iguales a " + max_primo);
                            this.textP.setText("");
                            this.textQ.setText(""); 
                            this.textModulo.setText("");
                        }
                        else{
                            this.rsa_aprender.GenerarModulo();                            
                            this.textModulo.setText(Long.toString(this.rsa_aprender.ObtenerModulo()));
                            this.botContinuarPaso1.setEnabled(true);
                        }
                    }
                }                               
            }
        }
    }//GEN-LAST:event_botCalcularModuloMousePressed

    private void textModuloActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textModuloActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textModuloActionPerformed

    private void textQActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textQActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textQActionPerformed

    private void textPActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_textPActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_textPActionPerformed

    private void botPrimosAleatorioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_botPrimosAleatorioActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_botPrimosAleatorioActionPerformed

    private void botPrimosAleatorioMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_botPrimosAleatorioMousePressed
        this.rsa_aprender.GenerarPrimos();
        this.textP.setText(Long.toString(this.rsa_aprender.GetP()));
        this.textQ.setText(Long.toString(this.rsa_aprender.GetQ()));
        this.textModulo.setText("");
        this.botContinuarPaso1.setEnabled(false);
    }//GEN-LAST:event_botPrimosAleatorioMousePressed

    private RSA rsa_aprender;
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel IntroRSAPanel;
    private javax.swing.JTabbedPane RSATabbedPanel;
    private javax.swing.JButton botCalcularModulo;
    private javax.swing.JButton botComenzar;
    private javax.swing.JButton botContinuarEncriptar;
    private javax.swing.JButton botContinuarPaso1;
    private javax.swing.JButton botContinuarPaso2;
    private javax.swing.JButton botContinuarPaso3;
    private javax.swing.JButton botDesencriptarBloqueBloque;
    private javax.swing.JButton botDesencriptarTodo;
    private javax.swing.JButton botEncriptarBloque;
    private javax.swing.JButton botEncriptarBloques;
    private javax.swing.JButton botEncriptarTodo;
    private javax.swing.JButton botHallar_d;
    private javax.swing.JButton botHallar_e;
    private javax.swing.JButton botPrimosAleatorio;
    private javax.swing.JButton botTerminarDesencriptar;
    private javax.swing.JButton botTerminarEncriptar;
    private javax.swing.JButton botdesencriptarBloque;
    private javax.swing.JButton jButton4;
    private javax.swing.JDialog jDialog1;
    private javax.swing.JDialog jDialog2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JSeparator jSeparator2;
    private javax.swing.JLabel labelBloque;
    private javax.swing.JLabel labelBloqueDes;
    private javax.swing.JLabel labelRepNum;
    private javax.swing.JLabel labelRepNumdes;
    private javax.swing.JLabel labelTamBloq;
    private javax.swing.JLabel labelTamBloqDes;
    private javax.swing.JPanel panEncriptarBloques;
    private javax.swing.JPanel panEncriptarBloques1;
    private javax.swing.JPanel panelCalculosIniciales;
    private javax.swing.JPanel panelPaso1;
    private javax.swing.JPanel panelPaso2;
    private javax.swing.JPanel panelPaso3;
    private javax.swing.JPanel panelPaso4;
    private javax.swing.JPanel panelPaso5;
    private javax.swing.JPanel panelPaso6;
    private javax.swing.JSpinner spinTamBloque;
    private javax.swing.JSpinner spinTamBloqueDes;
    private javax.swing.JTextField textASCIIdesencriptar;
    private javax.swing.JTextField textASCIIencriptar;
    private javax.swing.JTextField textBloqueDesencriptar;
    private javax.swing.JTextField textBloqueEncriptar;
    private javax.swing.JTextField textIntervalo_d;
    private javax.swing.JTextField textMensCifrado;
    private javax.swing.JTextField textMensOriginalDesencriptar;
    private javax.swing.JTextField textMensajeDesencriptar;
    private javax.swing.JTextField textMensajeEncriptar;
    private javax.swing.JTextField textModulo;
    private javax.swing.JTextField textP;
    private javax.swing.JTextField textQ;
    private javax.swing.JTextField text_claveprivada;
    private javax.swing.JTextField text_claveprivada1;
    private javax.swing.JTextField text_d;
    private javax.swing.JTextField text_d_paso3;
    private javax.swing.JTextField text_e_paso3;
    private javax.swing.JTextField text_p_paso2;
    private javax.swing.JTextField text_p_paso3;
    private javax.swing.JTextField text_q_paso2;
    private javax.swing.JTextField text_q_paso3;
    // End of variables declaration//GEN-END:variables
}
